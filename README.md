# Link Space Chat - 即时聊天工具

本工具是一个轻量级的即时消息平台，专为跨网络环境（局域网/公共互联网）设计。它允许用户通过链接快速加入聊天室，无需注册或安装客户端。

**项目还在不断完善, 暂时没有完善mvp功能**

**更新时间**: 2025年11月（Phase 2 轻量级功能增强已完成）
---

## 目录
- [项目运行与测试指南](#项目运行与测试指南)
  - [一、环境准备](#一环境准备)
  - [二、本地部署](#二本地部署)
  - [三、启动服务](#三启动服务)
  - [四、端口配置](#四端口配置)
  - [五、数据库说明](#五数据库说明)
  - [六、开启公网访问 (可选)](#六开启公网访问-可选)
  - [七、消息频率限制](#七消息频率限制)
  - [八、功能测试](#八功能测试)
- [项目背景与设计](#项目背景与设计)
  - [项目简介](#项目简介)
  - [团队成员](#团队成员)
  - [技术栈](#技术栈)

---

## 项目运行与测试指南

本项目基于 Socket.IO 聊天示例改造，原始项目参考：[socketio/chat-example](https://github.com/socketio/chat-example)。

### 一、环境准备

- **Node.js**: 版本需 `16+`，推荐 `18+`。
- **操作系统**: 主要在 Windows 环境下开发，项目内包含 `.bat` 启动脚本。

### 二、本地部署

1.  **克隆仓库**
    ```bash
    git clone https://github.com/YouXiangyu/Link-Space-Chat.git
    cd Link-Space-Chat
    ```

2.  **安装依赖**
    在国内环境，建议使用 `cnpm` 或配置 `npm` 淘宝镜像源以加快速度。
    ```powershell
    # 使用 npm
    npm install

    # 或使用 cnpm
    # cnpm install
    ```

### 三、启动服务

启动后，服务将同时监听本地和局域网 IP，默认端口为 `3000`。关于如何修改端口和启用ngrok，请参考后续章节的说明。

#### 启动方式

1. **使用批处理文件 (Windows推荐)**
   ```cmd
   # 默认端口3000
   start-chat.bat
   
   # 指定端口
   start-chat.bat 4000
   
   # 启用ngrok（需要设置NGROK_AUTHTOKEN环境变量）
   start-chat.bat ngrok
   
   # 启用ngrok并指定端口
   start-chat.bat ngrok 4000
   ```

2. **使用PM2 (推荐用于生产环境)**
   ```bash
   # 默认端口3000
   pm2 start server.js
   
   # 指定端口
   pm2 start server.js -- 3001
   
   # 启用ngrok
   pm2 start server.js -- ngrok
   
   # 启用ngrok并指定端口
   pm2 start server.js -- ngrok 4000
   ```

3. **使用npm脚本**
   ```powershell
   npm run start
   ```

4. **直接使用node**
   ```bash
   # 默认端口
   node server.js
   
   # 指定端口
   node server.js 3001
   
   # 启用ngrok
   node server.js ngrok
   
   # 启用ngrok并指定端口
   node server.js ngrok 4000
   ```

控制台将输出以下信息 (以端口3000为例)：
- **本地访问**: `http://localhost:3000`
- **局域网访问**: `http://<你的局域网IP>:3000`
- **公网访问** (如果启用了ngrok): `https://xxxxx.ngrok.io`

### 四、端口配置

本项目的端口可以通过多种方式进行配置，生效优先级从高到低如下：

1.  **命令行参数 (最高)**
    在启动时，将端口号作为参数传入。这是最快捷的临时修改方式。
    ```cmd
    # 使用批处理文件
    start-chat.bat 4000
    
    # 使用node直接启动
    node server.js 4000
    
    # 使用PM2
    pm2 start server.js -- 4000
    ```

2.  **环境变量**
    设置名为 `LINK_SPACE_PORT` 的环境变量。此方式适合较为固定的配置。
    - **Windows (CMD)**:
      ```cmd
      set LINK_SPACE_PORT=4000
      npm run start
      ```
    - **Windows (PowerShell)**:
      ```powershell
      $env:LINK_SPACE_PORT = "4000"
      npm run start
      ```

3.  **默认值 (最低)**
    如果以上两种方式都未设置，则使用默认端口 `3000`。

### 五、数据库说明

- **数据库文件**: 项目使用 SQLite 数据库存储聊天记录，文件名为 `chat.db`。
- **自动创建**: 您**无需**手动创建数据库。首次启动服务时，`sqlite.js` 脚本会自动检测并创建 `chat.db` 文件及所需的数据表（`rooms` 和 `messages`）。
- **文件忽略**: `chat.db` 文件包含了所有的聊天历史记录。为了避免将个人或测试的聊天数据提交到版本控制系统（如 Git），`.gitignore` 文件已配置为忽略 `chat.db`。这确保了仓库的干净，同时保护了本地数据的私密性。

### 六、开启公网访问 (可选)

本项目集成了 `ngrok`，可以将本地服务暴露到公网，方便外网用户访问。

#### 1. 获取 ngrok Authtoken

- 前往 [ngrok 官网](https://ngrok.com/) 注册并登录。
- 在 [Your Authtoken](https://dashboard.ngrok.com/get-started/your-authtoken) 页面找到你的专属令牌 (Token)。

#### 2. 配置并启动

设置环境变量 `NGROK_AUTHTOKEN`，然后在启动时添加 `ngrok` 参数：

- **Windows (CMD)**:
  ```cmd
  set NGROK_AUTHTOKEN=这里替换成你的Token
  start-chat.bat ngrok
  ```

- **Windows (PowerShell)**:
  ```powershell
  $env:NGROK_AUTHTOKEN = "这里替换成你的Token"
  start-chat.bat ngrok
  ```

- **使用PM2**:
  ```bash
  export NGROK_AUTHTOKEN=你的Token  # Linux/Mac
  set NGROK_AUTHTOKEN=你的Token      # Windows CMD
  pm2 start server.js -- ngrok
  ```

启动成功后，控制台会额外输出一个公网 URL，形如 `https://xxxxx.ngrok.io`。其他用户可通过此地址访问你的聊天室。

> **注意**: 如果未设置 `NGROK_AUTHTOKEN` 环境变量，服务仍会正常启动，但ngrok功能将无法使用，控制台会显示警告信息。

### 七、消息频率限制

为了防止消息刷屏和滥用，系统实现了消息频率限制功能：

- **限制规则**: 每 3 秒最多发送 5 条消息
- **超过限制**: 当用户发送消息过于频繁时，消息将不会被发送，前端会显示一个浮动的提示信息（橙色提示框，3秒后自动消失）
- **提示位置**: 提示信息会显示在输入框上方，不会遮挡主要界面

### 八、功能测试

- **健康检查**: 访问 `http://localhost:3000/health`，应返回详细的健康状态信息（内存、连接数、数据库统计等）。
- **基本聊天**: 在不同浏览器标签页打开 `http://localhost:3000/r/test`，输入昵称后即可开始聊天。
- **历史记录**: 刷新页面，应能自动加载最近的 20 条消息。
- **在线列表**: 侧边栏应实时显示当前房间的在线用户。
- **消息频率限制**: 快速连续发送多条消息（超过5条/3秒），应看到频率限制提示。

### 九、Phase 1 性能优化功能

Phase 1 已完成，新增以下功能和优化：

#### 环境变量配置

- **MESSAGE_RETENTION_DAYS**: 消息保留天数（默认1天）
  ```powershell
  $env:MESSAGE_RETENTION_DAYS = "3"  # 保留3天消息
  ```

- **ENABLE_REQUEST_LOG**: 启用请求日志（默认关闭）
  ```powershell
  $env:ENABLE_REQUEST_LOG = "true"  # 启用请求日志
  ```

#### 新增功能

1. **数据库优化**
   - 启用 WAL 模式，提升并发性能
   - 优化索引（联合索引 `room_id, created_at DESC`）
   - 消息自动清理（每小时执行一次，清理超过保留天数的消息）
   - 数据库迁移脚本（确保向后兼容）

2. **内存管理**
   - 房间和用户列表延迟清理（断开连接后3分钟删除，避免频繁创建）
   - 内存使用监控和告警（超过80%时告警）
   - Socket.IO 心跳检测优化（25秒心跳间隔，60秒超时）

3. **监控与健康检查**
   - 增强 `/health` 端点，返回：
     - 内存使用情况（堆内存、系统内存）
     - 连接数（活跃连接、房间数）
     - 数据库统计（大小、消息数、房间数）
     - 慢请求记录（最近10条）
   - 性能监控中间件（记录超过1秒的慢请求）
   - 定期健康检查（每3分钟检查数据库连接）

4. **代码优化**
   - 统一错误处理格式（包含错误码和错误消息）
   - 请求日志中间件（可选，通过环境变量控制）
   - JSDoc 注释完善（关键函数添加注释）

#### 性能提升

- 数据库查询优化：使用联合索引，查询速度提升
- 内存占用优化：延迟清理机制减少内存占用
- 并发性能提升：WAL 模式支持更高并发

---

## 项目背景与设计

### 项目简介

随着移动互联网和即时消息（IM）工具的普及，人们对“即时、便捷、私密”的通信需求持续增长。本项目旨在将一个基于 Socket.IO 的最小聊天原型，发展成一个支持跨网络环境（局域网/公共互联网）的轻量级、可自托管的即时消息平台。

其核心模式是：
1.  **任何人都可以成为服务器**：用户可以一键在本地启动一个临时聊天室。
2.  **跨网络支持**：房间可通过局域网链接访问，并可选择通过NAT穿透暴露于公共互联网。
3.  **零摩擦加入**：其他用户无需注册或安装应用程序；他们可以通过链接直接在浏览器中加入。

### 团队成员

- **组长**: 游翔宇 (1230006152)
- **组员**: 孙宇轩 (1230019445)
- **组员**: 邢天舒 (1230002381)

### 技术栈

- **后端**: Node.js + Express.js
- **实时通信**: Socket.IO
- **数据库**: SQLite
- **公网暴露**: ngrok
- **进程管理**: PM2 (可选)
- **前端**: HTML, CSS, JavaScript
- **安全特性**: 消息频率限制、昵称唯一性检查

---

## 未来功能开发计划

本项目采用渐进式开发策略，在保持**零认证门槛**、**轻量化**和**高性能**的前提下，逐步增强功能。所有升级都经过性能优化，确保在4核4G轻量级服务器上稳定运行。

### 设计原则

1. **零认证门槛**: 保持无需注册即可使用的特性
2. **轻量化优先**: 避免过度设计，保持代码简洁
3. **性能至上**: 所有功能都需考虑资源占用和查询效率
4. **渐进增强**: 每个阶段独立可用，可随时停止升级

### 最终目标（长期愿景）

- ✅ 零认证、轻量级聊天平台
- ✅ 支持多种消息类型（文本、表情、文件、投票）
- ✅ 消息回复和引用功能
- ✅ 房间名称和描述
- ✅ 消息搜索和历史记录管理
- ✅ 性能优化和缓存机制
- ✅ 更好的移动端体验

---

### Phase 1: 性能优化与稳定性提升 ⚡

**目标**: 优化现有功能，提升性能和稳定性，为后续功能打好基础

**预计时间**: 1-2周

**性能影响**: ⬇️ 降低资源占用

#### Todo 清单

- [x] **数据库优化** ✅
  - [x] 添加消息表的 `room_id` 和 `created_at` 联合索引优化
  - [x] 实现消息自动清理机制（保留最近N天，默认1天，可通过环境变量配置）
  - [x] 添加数据库连接池配置（SQLite WAL模式，提升并发性能）
  - [x] 优化查询语句，减少不必要的数据传输（只查询需要的字段）
  - [x] 添加数据库迁移脚本，确保向后兼容

- [x] **内存管理** ✅
  - [x] 实现房间和用户列表的定期清理（断开连接后延迟3分钟删除，避免频繁创建）
  - [x] 添加内存使用监控和告警（超过80%内存使用率时告警）
  - [x] 优化 Socket.IO 连接管理（心跳检测优化）
  - [x] 实现消息频率限制的数据结构优化（使用Map而非Array，提升查找效率）

- [x] **代码优化** ✅
  - [x] 重构消息频率限制逻辑，使用更高效的数据结构（已完成，检查是否需要进一步优化）
  - [x] 添加请求日志（可选，生产环境可关闭，通过环境变量控制）
  - [x] 优化错误处理机制（统一错误格式，添加错误码）
  - [x] 代码注释完善（关键函数添加JSDoc注释）

- [x] **监控与健康检查** ✅
  - [x] 增强 `/health` 端点，返回内存、连接数、数据库大小等指标
  - [x] 添加性能监控中间件（可选，记录慢请求）
  - [x] 实现健康检查的定期自检（每3分钟检查一次数据库连接）

**验收标准**:
- 内存占用降低 20% 以上
- 数据库查询速度提升 30% 以上
- 支持 100+ 并发连接无压力

---

### Phase 2: 轻量级功能增强 🎨 ✅

**目标**: 添加基础但实用的功能，保持轻量化

**预计时间**: 2-3周

**性能影响**: ➡️ 轻微增加（<5%）

**完成时间**: 2025年11月

#### Todo 清单

- [x] **房间功能增强** ✅
  - [x] 为 `rooms` 表添加 `name` 字段（房间名称，可选）
  - [x] 为 `rooms` 表添加 `description` 字段（房间描述，可选）
  - [x] 为 `rooms` 表添加 `password` 字段（房间密码，NULL表示开放房间）
  - [x] 为 `rooms` 表添加 `creator_session` 字段（创建者session_id，用于权限判断）
  - [x] 实现数据库迁移脚本（向后兼容，使用ALTER TABLE ADD COLUMN IF NOT EXISTS）
  - [x] 前端支持显示和编辑房间名称（侧边栏添加编辑按钮）
  - [x] 前端支持设置房间密码（创建者功能，密码长度限制4-20字符）
  - [x] 前端支持加入密码房间（输入密码界面，密码错误提示）
  - [x] 实现密码验证逻辑（join_room时验证，密码错误返回明确错误信息）
  - [x] 实现修改密码功能（创建者可修改，修改时清空聊天记录并通知所有用户）
  - [x] 实现取消密码功能（创建者可以移除密码，变为开放房间）
  - [x] 限制默认房间（"1"）不能设置密码（前端和后端双重验证）
  - [x] 添加房间信息显示（显示房间是否有密码、创建者信息等）

- [x] **消息类型支持** ✅
  - [x] 为 `messages` 表添加 `content_type` 字段（text/emoji/file等，默认'text'）
  - [x] 实现消息类型自动检测逻辑（检测Emoji、URL等）
  - [x] 支持 Emoji 表情消息（支持Unicode Emoji，如 😀 🎉 ✅ 等）
  - [x] 前端渲染不同类型的消息（不同消息类型使用不同样式）

- [x] **用户体验优化** ✅
  - [x] 消息时间显示优化（相对时间：刚刚、1分钟前等）
  - [x] 添加消息发送状态指示（发送中、已发送）
  - [x] 优化移动端响应式布局
  - [x] 添加键盘快捷键（Enter发送，Shift+Enter换行）
  - [x] 界面美化：优化CSS样式，提升视觉效果（渐变背景、动画效果、自定义滚动条等）

**数据库变更**:
```sql
ALTER TABLE rooms ADD COLUMN name TEXT;
ALTER TABLE rooms ADD COLUMN description TEXT;
ALTER TABLE rooms ADD COLUMN password TEXT;  -- NULL表示开放房间，有值表示需要密码
ALTER TABLE rooms ADD COLUMN creator_session TEXT;  -- 创建者的session_id（用于判断修改权限）
ALTER TABLE messages ADD COLUMN content_type TEXT DEFAULT 'text';
```

**房间密码功能设计**:
- **零认证原则**: 使用 `creator_session`（Socket.IO session ID）而非用户ID，无需用户表
- **密码机制**: 
  - `password` 为 NULL = 开放房间（无需密码）
  - `password` 有值 = 需要密码才能加入
  - 默认房间（ID为"1"）强制开放，不能设置密码
- **创建者权限**: 
  - 第一个加入房间的人自动成为创建者（记录 `creator_session`）
  - 创建者可以设置/修改密码
  - 修改密码时，清空所有聊天记录（刷新房间机制）
- **性能影响**: 极小（仅增加一次字符串比较）

**验收标准**:
- ✅ 房间可以设置名称和描述
- ✅ 房间可以设置密码（创建者功能）
- ✅ 加入密码房间需要输入正确密码
- ✅ 默认房间（"1"）不能设置密码
- ✅ 修改密码会清空聊天记录（刷新房间）
- ✅ 支持发送和显示 Emoji
- ✅ 移动端体验流畅
- ✅ 界面美观，用户体验良好

**新增功能说明**:
1. **房间管理**：创建者可以设置房间名称、描述和密码，其他用户加入密码房间时需要输入密码
2. **消息类型**：自动检测Emoji消息并应用特殊样式显示
3. **时间显示**：使用相对时间（刚刚、1分钟前等）提升可读性
4. **发送状态**：显示消息发送状态，提升用户反馈
5. **键盘快捷键**：Enter发送消息，Shift+Enter换行
6. **界面优化**：美化界面样式，添加动画效果和自定义滚动条

---

### Phase 3: 消息交互功能 💬

**目标**: 增强消息交互能力，提升用户体验

**预计时间**: 2-3周

**性能影响**: ➡️ 轻微增加（<8%）

#### Todo 清单

- [ ] **消息回复功能**
  - [ ] 为 `messages` 表添加 `parent_message_id` 字段（支持回复，可为NULL）
  - [ ] 添加外键约束和索引（parent_message_id索引，提升查询性能）
  - [ ] 实现消息回复逻辑（前端点击消息可回复，显示回复按钮）
  - [ ] 前端显示回复关系（引用样式，显示被回复的消息内容）
  - [ ] 优化回复消息的显示格式（嵌套显示，最多显示2层）
  - [ ] 实现回复消息的跳转功能（点击回复可跳转到原消息）

- [ ] **消息高亮功能**
  - [ ] 为 `messages` 表添加 `is_highlighted` 字段
  - [ ] 实现消息高亮逻辑（@用户、关键词等）
  - [ ] 前端支持高亮消息样式

- [ ] **消息搜索（轻量级）**
  - [ ] 实现基于 SQLite FTS5（全文搜索）的消息搜索
  - [ ] 实现FTS索引与messages表的同步机制（新消息自动同步到FTS表）
  - [ ] 前端添加搜索框（仅搜索当前房间，实时搜索）
  - [ ] 搜索结果高亮显示（关键词高亮，显示匹配的消息）
  - [ ] 添加搜索结果数量限制（最多显示50条结果，避免性能问题）
  - [ ] 实现搜索历史记录（可选，本地存储最近搜索关键词）

**数据库变更**:
```sql
ALTER TABLE messages ADD COLUMN parent_message_id INTEGER;
ALTER TABLE messages ADD COLUMN is_highlighted INTEGER DEFAULT 0;
CREATE INDEX idx_messages_parent ON messages(parent_message_id);
CREATE VIRTUAL TABLE messages_fts USING fts5(room_id, nickname, text);
```

**验收标准**:
- 可以回复任意消息
- 支持消息高亮
- 可以在房间内搜索历史消息

---

### Phase 4: 文件传输功能 📁

**目标**: 支持轻量级文件传输（小文件，避免服务器压力）

**预计时间**: 3-4周

**性能影响**: ⬆️ 中等增加（10-15%，取决于使用频率）

#### Todo 清单

- [ ] **文件上传基础**
  - [ ] 添加文件上传中间件（限制文件大小，默认5MB，可通过配置调整）
  - [ ] 实现文件存储逻辑（本地存储到 `public/uploads/` 目录，按日期分文件夹）
  - [ ] 为 `messages` 表扩展 `content` 字段支持 JSON 格式存储文件信息（向后兼容，现有text消息不受影响）
  - [ ] 实现文件上传的API端点（POST /api/upload）
  - [ ] 添加文件类型白名单（图片：jpg, png, gif, webp；文档：pdf, doc, docx, txt）
  - [ ] 实现文件上传的安全验证（文件名清理，防止路径遍历攻击）

- [ ] **文件类型支持**
  - [ ] 支持图片预览（jpg, png, gif, webp）
  - [ ] 支持文档类型（pdf, doc等，仅显示下载链接）
  - [ ] 文件大小和类型验证

- [ ] **性能优化**
  - [ ] 实现文件上传进度显示
  - [ ] 添加文件自动清理机制（30天后删除未使用的文件）
  - [ ] 图片压缩和缩略图生成（可选）

**数据库变更**:
```sql
-- content 字段改为 TEXT，存储 JSON
-- 示例: {"type": "file", "filename": "xxx.jpg", "url": "/files/xxx.jpg", "size": 12345}
```

**验收标准**:
- 可以上传和分享图片（自动预览）
- 可以上传其他类型文件（显示下载链接）
- 文件大小限制有效
- 不影响聊天性能

---

### Phase 5: 投票功能 🗳️

**目标**: 实现轻量级投票功能（无需用户认证）

**预计时间**: 2-3周

**性能影响**: ➡️ 轻微增加（<5%）

#### Todo 清单

- [ ] **投票数据模型**
  - [ ] 创建 `polls` 表（关联消息）
  - [ ] 创建 `poll_options` 表（投票选项）
  - [ ] 创建 `votes` 表（投票记录，使用 session_id 而非 user_id）

- [ ] **投票功能实现**
  - [ ] 前端投票创建界面（选项数量限制2-10个，选项文本长度限制100字符）
  - [ ] 投票消息渲染（显示选项和实时结果，显示投票人数）
  - [ ] 投票逻辑（一人一票，基于 session，防止重复投票）
  - [ ] 投票结果实时更新（使用Socket.IO实时推送投票结果）
  - [ ] 添加投票截止时间功能（可选，创建投票时可设置截止时间）
  - [ ] 实现投票结果可视化（进度条显示各选项得票率）

- [ ] **性能优化**
  - [ ] 投票结果缓存（避免频繁查询）
  - [ ] 优化投票查询 SQL

**数据库变更**:
```sql
CREATE TABLE polls (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    message_id INTEGER NOT NULL,
    FOREIGN KEY(message_id) REFERENCES messages(id)
);

CREATE TABLE poll_options (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    poll_id INTEGER NOT NULL,
    option_text TEXT NOT NULL,
    FOREIGN KEY(poll_id) REFERENCES polls(id)
);

CREATE TABLE votes (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    option_id INTEGER NOT NULL,
    session_id TEXT NOT NULL,  -- 使用 session 而非 user_id
    created_at INTEGER NOT NULL,
    FOREIGN KEY(option_id) REFERENCES poll_options(id),
    UNIQUE(option_id, session_id)  -- 防止重复投票
);
```

**验收标准**:
- 可以创建投票消息
- 可以参与投票（一人一票）
- 投票结果实时显示
- 性能影响可接受

---

### Phase 6: 高级优化与扩展 🚀

**目标**: 性能优化、缓存机制、高级功能

**预计时间**: 3-4周

**性能影响**: ⬇️ 降低资源占用

#### Todo 清单

- [ ] **缓存机制**
  - [ ] 实现消息历史缓存（Redis 或内存缓存，可选）
  - [ ] 房间列表缓存
  - [ ] 在线用户列表缓存优化

- [ ] **消息分页优化**
  - [ ] 实现真正的消息分页（而非仅加载最近20条）
  - [ ] 前端支持滚动加载更多历史消息
  - [ ] 优化大量历史消息的渲染性能

- [ ] **性能监控**
  - [ ] 添加性能指标收集（响应时间、内存使用等）
  - [ ] 实现慢查询日志
  - [ ] 添加资源使用告警

- [ ] **高级功能（可选）**
  - [ ] 消息编辑和删除（仅发送者，有时间限制）
  - [ ] 房间密码保护（可选）
  - [ ] 消息导出功能

**验收标准**:
- 缓存机制有效降低数据库压力
- 支持加载更多历史消息
- 性能监控正常工作
- 整体性能提升 20% 以上

---

### 性能保障措施

为确保在4核4G服务器上稳定运行，每个阶段都会进行：

1. **性能测试**: 每个功能上线前进行压力测试
2. **资源监控**: 监控 CPU、内存、数据库大小
3. **代码审查**: 确保代码高效，避免性能瓶颈
4. **渐进部署**: 新功能先在小范围测试，确认无性能问题后再全量

### 升级策略

- **可选升级**: 每个阶段都是独立的，可以根据需求选择性实现
- **向后兼容**: 数据库变更都使用 `ALTER TABLE ADD COLUMN`，保证向后兼容
- **回滚机制**: 每个阶段都有回滚方案，出现问题可快速恢复

### 注意事项

⚠️ **重要**: 
- 所有数据库变更都会先备份
- 新功能默认关闭，可通过配置开启
- 文件传输功能需要额外存储空间，需监控磁盘使用
- 投票功能使用 session 而非用户ID，确保零认证门槛

---

**最后更新**: 2025年11月